# ğŸš¨ ì•ˆë†€ì ë´‡ (vcms-slack-anolja-bot)

ì•¼ë†€ì 403 ì¥ì• ë¥¼ **ìë™ ê°ì§€**í•˜ê³ , Slack ì•Œë¦¼ê³¼ **ì›í´ë¦­ ë¬¸ì ë°œì†¡**ìœ¼ë¡œ ì¥ì•  ëŒ€ì‘ì„ ìë™í™”í•˜ëŠ” ë´‡ì…ë‹ˆë‹¤.

> ì‚¬ëŒì´ ë¨¼ì € í™•ì¸í•˜ëŠ” ê²Œ ì•„ë‹ˆë¼, ë´‡ì´ ë¨¼ì € ì¥ì• ë¥¼ ê°ì§€í•´ì„œ ì•Œë ¤ì¤ë‹ˆë‹¤.
> ë¬¸ì ë°œì†¡ ë¬¸êµ¬ëŠ” ë‹´ë‹¹ìê°€ ì§ì ‘ í™•ì¸í•˜ê³  ì»¨íŒí•œ ë’¤ì—ë§Œ ë°œì†¡ë©ë‹ˆë‹¤.

---

## í•µì‹¬ í”Œë¡œìš°

```
5ë¶„ ì£¼ê¸° ìë™ ê°ì§€ (Retool ì²´í¬ ì›Œí¬í”Œë¡œìš°)
        â”‚
        â”‚  ì—ëŸ¬ ìˆ™ë°•ì—…ì†Œ â‰¥ 30ê°œ
        â–¼
Slack ì±„ë„ ì•Œë¦¼ (í•˜ë£¨ ìŠ¤ë ˆë“œ ê·¸ë£¹í•‘)
        â”‚
        â”‚  [ë¬¸ì ë°œì†¡] ë²„íŠ¼ í´ë¦­
        â–¼
Slack ëª¨ë‹¬ (6ì¢… í…œí”Œë¦¿ ì„ íƒ + ë¬¸êµ¬ ìˆ˜ì • + í™•ì¸ ì²´í¬ë°•ìŠ¤ 2ê°œ)
        â”‚
        â”‚  ë‹´ë‹¹ì ì»¨íŒ (ë ˆì´ìŠ¤ ì»¨ë””ì…˜ ì²´í¬ â†’ 1ì¸ë§Œ í†µê³¼)
        â–¼
Retool Workflow (ëŒ€ìƒ ì¶”ì¶œ) â†’ Solapi ë¬¸ì ë°œì†¡
        â”‚
        â–¼
ìŠ¤ë ˆë“œ ê²°ê³¼ íšŒì‹ :
  â‘  âœ… ë°œì†¡ ê²°ê³¼ (ì„±ê³µ/ì‹¤íŒ¨ ê±´ìˆ˜)
  â‘¡ ğŸ“‹ ìˆ™ë°•ì—…ì†Œë³„ ë²ˆí˜¸ ë¦¬ìŠ¤íŠ¸
  â‘¢ ğŸ“ CSV íŒŒì¼ ë°±ì—…
  â‘£ âš ï¸ ì‹¤íŒ¨ ìƒì„¸ (ìˆì„ ê²½ìš°)
        â”‚
        â”‚  ì—ëŸ¬ ìˆ™ë°•ì—…ì†Œ â‰¤ 10ê°œ
        â–¼
ì •ìƒí™” ìë™ ê°ì§€ â†’ ê°™ì€ ìŠ¤ë ˆë“œì— í•´ì œ ì•Œë¦¼
```

---

## ìƒíƒœ ë¨¸ì‹ 

| ìƒíƒœ | ì¡°ê±´ | Slack ë™ì‘ | ë¬¸ì |
|------|------|-----------|------|
| **ì •ìƒ â†’ ì¥ì• ** | ì—ëŸ¬ ìˆ™ë°•ì—…ì†Œ â‰¥ 30ê°œ | í•˜ë£¨ ìŠ¤ë ˆë“œì— ì•Œë¦¼ + ë°œì†¡ ë²„íŠ¼ | ë‹´ë‹¹ì ëª¨ë‹¬ ì»¨íŒ ì‹œ 1íšŒ |
| **ì¥ì•  ì§€ì†** | 30ê°œ ì´ìƒ ìœ ì§€ | ì¶”ê°€ ì•Œë¦¼ ì—†ìŒ | ë°œì†¡ ë¶ˆê°€ (ë²„íŠ¼ ë¹„í™œì„±í™”) |
| **ì¥ì•  â†’ ì •ìƒí™”** | ì—ëŸ¬ ìˆ™ë°•ì—…ì†Œ â‰¤ 10ê°œ | ê°™ì€ ìŠ¤ë ˆë“œì— ì •ìƒí™” ì•Œë¦¼ | ë‹´ë‹¹ì ëª¨ë‹¬ ì»¨íŒ ì‹œ 1íšŒ |

### í•µì‹¬ ê·œì¹™

- **ì¥ì•  ë°œìƒ ë¬¸ì 1íšŒ + í•´ì œ ë¬¸ì 1íšŒ** â€” í•˜ë‚˜ì˜ ì¥ì•  ì´ë²¤íŠ¸ì—ì„œ ìµœëŒ€ 2íšŒ ë°œì†¡
- **ëª¨ë“  ë¬¸ì ë°œì†¡ì€ ë‹´ë‹¹ì ì»¨íŒ í•„ìˆ˜** â€” ëª¨ë‹¬ì—ì„œ ë¬¸êµ¬ í™•ì¸ + í™•ì¸ ì²´í¬ë°•ìŠ¤ 2ê°œ
- **ì¤‘ë³µ ë°œì†¡ ì›ì²œ ì°¨ë‹¨** â€” ë™ì‹œì— ì—¬ëŸ¬ ëª…ì´ ëª¨ë‹¬ì„ ì—´ì–´ë„ 1ì¸ë§Œ ë°œì†¡ í†µê³¼
- **ë°œì†¡ì ìë™ ê¸°ë¡** â€” ëˆ„ê°€ ë°œì†¡ì„ ìŠ¹ì¸í–ˆëŠ”ì§€ ê²°ê³¼ ë©”ì‹œì§€ì— ëª…ì‹œ
- **ë²„íŠ¼ 1íšŒìš©** â€” ë°œì†¡ ì»¨íŒ ì¦‰ì‹œ ë²„íŠ¼ ë¹„í™œì„±í™”, ì¬ë°œì†¡ ë¶ˆê°€
- **ë°œì†¡ ì•ˆí•¨ë„ ë¡œê·¸** â€” ë°œì†¡ ì•ˆí•¨ í´ë¦­ ì‹œ ëˆ„ê°€ ì–¸ì œ ì²˜ë¦¬í–ˆëŠ”ì§€ ìŠ¤ë ˆë“œì— ë°•ì œ
- **ë°œì†¡ ê²°ê³¼ CSV ë°±ì—…** â€” ëª¨ë“  ë°œì†¡ ê²°ê³¼ë¥¼ CSV íŒŒì¼ë¡œ ìŠ¤ë ˆë“œì— ì²¨ë¶€
- **ìˆ™ë°•ì—…ì†Œë³„ ë²ˆí˜¸ ë¦¬ìŠ¤íŠ¸** â€” ì–´ë””ì— ë¬¸ì ê°”ëŠ”ì§€ ìŠ¤ë ˆë“œì— ê¸°ë¡

---

## í•˜ë£¨ ìŠ¤ë ˆë“œ ê·¸ë£¹í•‘

ê°™ì€ ë‚  ì•Œë¦¼ì„ í•˜ë‚˜ì˜ ìŠ¤ë ˆë“œë¡œ ë¬¶ì–´ì„œ ì±„ë„ ë„ë°°ë¥¼ ë°©ì§€í•©ë‹ˆë‹¤.

```
[ì±„ë„] ğŸš¨ ì•¼ë†€ì 403 ì—°ë™ ì§€ì—° ê°ì§€ (2026-02-22)
  â”œâ”€ [ìŠ¤ë ˆë“œ] ğŸš¨ 02:00 ì¥ì•  ë°œìƒ (32ê°œ) [ë¬¸ì ë°œì†¡] [ë¬¸ì ë°œì†¡ ì•ˆí•¨]
  â”œâ”€ [ìŠ¤ë ˆë“œ] âœ… 02:10 ì •ìƒí™” (8ê°œ)   [ë¬¸ì ë°œì†¡] [ë¬¸ì ë°œì†¡ ì•ˆí•¨]
  â””â”€ [ìŠ¤ë ˆë“œ] ğŸš¨ 03:25 ì¬ë°œìƒ (35ê°œ)  [ë¬¸ì ë°œì†¡] [ë¬¸ì ë°œì†¡ ì•ˆí•¨]
```

---

## ë¬¸êµ¬ í…œí”Œë¦¿ (6ì¢…)

ëª¨ë‹¬ ìƒë‹¨ì— ë“œë¡­ë‹¤ìš´ìœ¼ë¡œ ë¹ ë¥¸ ì„ íƒ ì œê³µ. ì„ íƒ ì‹œ í…ìŠ¤íŠ¸ ë°•ìŠ¤ì— ìë™ ì±„ì›Œì§€ê³ , ë‹´ë‹¹ìê°€ ììœ ë¡­ê²Œ ìˆ˜ì • ê°€ëŠ¥.

| í…œí”Œë¦¿ | ìš©ë„ |
|--------|------|
| **[ê¸´ê¸‰] ì¥ì•  ì•ˆë‚´** | ì¥ì•  ë°œìƒ ì´ˆê¸° ì•ˆë‚´ |
| **[ì•ˆë‚´] ì ‘ìˆ˜ ì¤‘** | ì¥ì•  ì¸ì§€ í›„ ì ‘ìˆ˜ ì•ˆë‚´ |
| **[ì§€ì—°] ë³µêµ¬ ì§€ì—°** | ë³µêµ¬ê°€ ê¸¸ì–´ì§ˆ ë•Œ |
| **[ë¶€ë¶„] ì¼ë¶€ ë³µêµ¬** | ì¼ë¶€ ìˆ™ë°•ì—…ì†Œë§Œ ë³µêµ¬ ì‹œ |
| **[ì™„ë£Œ] ì •ìƒ ë³µêµ¬** | ì „ì²´ ë³µêµ¬ ì™„ë£Œ |
| **ì§ì ‘ ì…ë ¥** | ë‹´ë‹¹ìê°€ ì§ì ‘ ì‘ì„± |

---

## ë°œì†¡ ê²°ê³¼ ìŠ¤ë ˆë“œ

ë¬¸ì ë°œì†¡ í›„ ì›ë³¸ ë©”ì‹œì§€ ìŠ¤ë ˆë“œì— ìë™ìœ¼ë¡œ 4ê°€ì§€ê°€ ë¶™ìŠµë‹ˆë‹¤:

### â‘  ë°œì†¡ ê²°ê³¼
```
âœ… ë¬¸ì ë°œì†¡ ì™„ë£Œ (ì´ 42ê±´)
ì„±ê³µ: 42ê±´
ì‹¤íŒ¨: 0ê±´
ë°œì†¡ ìŠ¹ì¸ì: @í™ê¸¸ë™
ì„ íƒ í…œí”Œë¦¿: [ê¸´ê¸‰] ì¥ì•  ì•ˆë‚´
ë°œì†¡ì¼ì‹œ: 2026-02-22 08:45:29
```

### â‘¡ ìˆ™ë°•ì—…ì†Œë³„ ë²ˆí˜¸ ë¦¬ìŠ¤íŠ¸
```
ğŸ“‹ ë°œì†¡ ëŒ€ìƒ ëª©ë¡ (42ê±´ / 16ê°œ ìˆ™ë°•ì—…ì†Œ)

1. OOí˜¸í…”
  â”” 010-****-1234
2. XXë¦¬ì¡°íŠ¸
  â”” 010-****-5678
  â”” 010-****-9012
...
```

### â‘¢ CSV íŒŒì¼ ë°±ì—…
`ë¬¸ì-ë°œì†¡ê²°ê³¼-2026-02-22-08-45-29.csv` (ì—‘ì…€ í˜¸í™˜, í•œê¸€ ê¹¨ì§ ë°©ì§€ BOM í¬í•¨)

| ë²ˆí˜¸ | ìˆ™ë°•ì—…ì†Œëª… | ë°œì†¡ìƒíƒœ | ë°œì†¡ì¼ì‹œ | ë¬¸ìë‚´ìš© |
|------|-----------|---------|---------|---------|
| 010-****-1234 | OOí˜¸í…” | ë°œì†¡ì™„ë£Œ | 2026-02-22 08:45:29 | [ì•ˆë‚´] í˜„ì¬... |

### â‘£ ì‹¤íŒ¨ ìƒì„¸ (ì‹¤íŒ¨ ê±´ ìˆì„ ê²½ìš°)
```
âš ï¸ ë°œì†¡ ì‹¤íŒ¨ ìƒì„¸: 2ê±´
  OOí˜¸í…” (010-****-1234): ê²°ë²ˆ í˜¹ì€ ìˆ˜ì‹  ê±°ë¶€
  XXë¦¬ì¡°íŠ¸ (010-****-5678): ìˆ˜ì‹  ê±°ë¶€
```

---

## ğŸ›¡ï¸ ì•ˆì „ì¥ì¹˜

### í™•ì¸ ì²´í¬ë°•ìŠ¤ 2ê°œ (ê°ê° í•„ìˆ˜)
```
â˜‘ ë¬¸ì ë‚´ìš©(ì˜¤íƒˆì, ë§í¬ ë“±)ì„ ë‹¤ì‹œ í•œ ë²ˆ í™•ì¸í–ˆìŠµë‹ˆë‹¤.
â˜‘ ë°œì†¡ ì™„ë£Œ í›„ì—ëŠ” ìˆ˜ì • ë° ì·¨ì†Œê°€ ë¶ˆê°€ëŠ¥í•œ ì ì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤.
```
Slack Block Kitì˜ ë‹¨ì¼ checkboxesëŠ” "ëª¨ë“  ì˜µì…˜ í•„ìˆ˜"ë¥¼ ì§€ì› ì•ˆ í•´ì„œ, 2ê°œ input ë¸”ë¡ìœ¼ë¡œ ë¶„ë¦¬í•˜ì—¬ ê°ê° required ì ìš©.

### ë ˆì´ìŠ¤ ì»¨ë””ì…˜ ë°©ì§€
ë‘ ëª…ì´ ë™ì‹œì— ëª¨ë‹¬ì„ ì—´ì–´ë„ `compareAndSet`ìœ¼ë¡œ 1ì¸ë§Œ í†µê³¼. ì´ë¯¸ ë°œì†¡ëœ ê±´ì´ë©´ ëª¨ë‹¬ì— ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ.

### ìƒíƒœ ì˜ì†í™”
`.alert-state.json` íŒŒì¼ì— ì¥ì•  ìƒíƒœë¥¼ ì €ì¥. pm2 ì¬ì‹œì‘ì´ë‚˜ ì„œë²„ ë¦¬ë¶€íŒ… ì‹œì—ë„ ìƒíƒœê°€ ìœ ì§€ë©ë‹ˆë‹¤.

---

## ğŸ”„ í™˜ê²½ ì „í™˜ ê°€ì´ë“œ

GCP SSHì—ì„œ `.env` íŒŒì¼ì„ ìˆ˜ì •í•©ë‹ˆë‹¤.

### í”„ë¡œë•ì…˜ ì „í™˜ (ì‹¤ì œ ìš´ì˜)
```bash
cd ~/vcms-slack-anolja-bot

# ì•Œë¦¼ ì±„ë„ â†’ lounge-vcms
sed -i 's/SLACK_ALERT_CHANNEL=.*/SLACK_ALERT_CHANNEL=C04ACB66X7C/' .env

# í…ŒìŠ¤íŠ¸ ë²ˆí˜¸ ì œê±° â†’ ì‹¤ì œ ìˆ™ë°•ì—…ì†Œë¡œ ë¬¸ì ë°œì†¡
sed -i '/TEST_PHONE/d' .env

pm2 restart anolja-bot
```

### í…ŒìŠ¤íŠ¸ ëª¨ë“œ ì „í™˜ (ê°œë°œ/í…ŒìŠ¤íŠ¸)
```bash
cd ~/vcms-slack-anolja-bot

# ì•Œë¦¼ ì±„ë„ â†’ public-vcms (í…ŒìŠ¤íŠ¸ìš©)
sed -i 's/SLACK_ALERT_CHANNEL=.*/SLACK_ALERT_CHANNEL=C0AF34D4MK5/' .env

# í…ŒìŠ¤íŠ¸ ë²ˆí˜¸ ì¶”ê°€ â†’ ëª¨ë“  ë¬¸ìê°€ ì´ ë²ˆí˜¸ë¡œë§Œ ë°œì†¡
echo "TEST_PHONE=010xxxx1234" >> .env

pm2 restart anolja-bot
```

### í˜„ì¬ í™˜ê²½ í™•ì¸
```bash
cat ~/vcms-slack-anolja-bot/.env
```

> âš ï¸ `.env`ëŠ” `.gitignore`ì— í¬í•¨ë˜ì–´ GitHubì— ì˜¬ë¼ê°€ì§€ ì•ŠìŠµë‹ˆë‹¤. GCP SSHì—ì„œë§Œ ìˆ˜ì • ê°€ëŠ¥í•©ë‹ˆë‹¤.

---

## ìë™ ë°°í¬ (CI/CD)

`main` ë¸Œëœì¹˜ì— pushí•˜ë©´ GitHub Actionsê°€ GCP ì„œë²„ì— ìë™ ë°°í¬í•©ë‹ˆë‹¤.

```
GitHub push (main) â†’ GitHub Actions â†’ GCP SSH â†’ git pull + pm2 restart
```

ë°°í¬ ìƒíƒœ: https://github.com/yujy118/vcms-slack-anolja-bot/actions

> âš ï¸ `README.md`, `.gitignore` ë³€ê²½ì€ ë°°í¬ íŠ¸ë¦¬ê±°í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

---

## ì„œë²„ ìš´ì˜

GCP Compute Engine (e2-micro, Always Free) + pm2ë¡œ 24ì‹œê°„ ìƒì‹œ ìš´ì˜.

### ì„œë²„ ì ‘ì†
GCP Console â†’ Compute Engine â†’ VM ì¸ìŠ¤í„´ìŠ¤ â†’ SSH ë²„íŠ¼

### ì£¼ìš” ëª…ë ¹ì–´ (GCP SSHì—ì„œ)
```bash
pm2 status                  # ë´‡ ìƒíƒœ í™•ì¸
pm2 logs anolja-bot         # ì‹¤ì‹œê°„ ë¡œê·¸
pm2 restart anolja-bot      # ì¬ì‹œì‘
pm2 stop anolja-bot         # ì¤‘ì§€
cat .env                    # í™˜ê²½ ë³€ìˆ˜ í™•ì¸
```

---

## ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GCP e2-micro (Always Free)  â”‚
â”‚  Slack Bolt (Node.js)        â”‚  Socket Mode (WebSocket ìƒì‹œ ì—°ê²°)
â”‚  + pm2 ë°±ê·¸ë¼ìš´ë“œ ì‹¤í–‰        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  5ë¶„ ì£¼ê¸° ìë™ ê°ì§€           â”‚â”€â”€â–¶ Retool ì²´í¬ ì›Œí¬í”Œë¡œìš° (ES ì¿¼ë¦¬)
â”‚  (errorChecker)              â”‚â—€â”€â”€ { shopCount, shopNames }
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ì¥ì• : â‰¥30ê°œ â†’ ì•Œë¦¼          â”‚
â”‚  ì •ìƒí™”: â‰¤10ê°œ â†’ í•´ì œ        â”‚
â”‚  í•˜ë£¨ ìŠ¤ë ˆë“œ ê·¸ë£¹í•‘           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [ë¬¸ì ë°œì†¡] ë²„íŠ¼ â†’ ëª¨ë‹¬     â”‚
â”‚  â†’ ë‹´ë‹¹ì ì»¨íŒ               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Retool ëŒ€ìƒ ì¶”ì¶œ WF         â”‚â”€â”€â–¶ DB ì¿¼ë¦¬ + ë²ˆí˜¸ ì •ì œ
â”‚                              â”‚â—€â”€â”€ { phones: [{number, name}] }
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Solapi ë¬¸ì ë°œì†¡             â”‚â”€â”€â–¶ ì¼ê´„ ë°œì†¡ API
â”‚                              â”‚â—€â”€â”€ ì„±ê³µ/ì‹¤íŒ¨ ê²°ê³¼
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ìŠ¤ë ˆë“œ íšŒì‹                   â”‚  ê²°ê³¼ + ë¦¬ìŠ¤íŠ¸ + CSV + ì‹¤íŒ¨ìƒì„¸
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  GitHub Actions CI/CD        â”‚  main push â†’ ìë™ ë°°í¬
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  .alert-state.json           â”‚  ìƒíƒœ ì˜ì†í™” (ì¬ì‹œì‘ ì‹œ ë³µì›)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ê¸°ìˆ  ìŠ¤íƒ

| êµ¬ë¶„ | ê¸°ìˆ  | ì—­í•  |
|------|------|------|
| ë´‡ í”„ë ˆì„ì›Œí¬ | **Slack Bolt (Node.js)** | Socket Mode, ëª¨ë‹¬, ë²„íŠ¼, ìŠ¤ë ˆë“œ |
| ìë™ ê°ì§€ | **errorChecker + Retool Workflow** | 5ë¶„ ì£¼ê¸° ES ì¿¼ë¦¬ â†’ ì„ê³„ì¹˜ íŒë‹¨ |
| ëŒ€ìƒ ì¶”ì¶œ | **Retool Workflow** | DB ì¿¼ë¦¬, ì¤‘ë³µ ì œê±°, ë²ˆí˜¸ ì •ì œ |
| ë¬¸ì ë°œì†¡ | **Solapi** | ë¬¸ì ì¼ê´„ ë°œì†¡ API |
| ìƒíƒœ ê´€ë¦¬ | **íŒŒì¼ ê¸°ë°˜ ì˜ì†í™”** (.alert-state.json) | ì¥ì•  ìƒíƒœ, ë ˆì´ìŠ¤ ì»¨ë””ì…˜ ë°©ì§€ |
| ë©”ì‹œì§€ UI | **Slack Block Kit + Modal** | ì•Œë¦¼, í…œí”Œë¦¿, ì²´í¬ë°•ìŠ¤, ê²°ê³¼ |
| ì„œë²„ | **GCP Compute Engine** | e2-micro Always Free (24ì‹œê°„) |
| í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬ | **pm2** | ë°±ê·¸ë¼ìš´ë“œ ì‹¤í–‰, ìë™ ì¬ì‹œì‘ |
| ìë™ ë°°í¬ | **GitHub Actions** | main push â†’ GCP SSH ë°°í¬ |

---

## í”„ë¡œì íŠ¸ êµ¬ì¡°

```
vcms-slack-anolja-bot/
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â””â”€â”€ deploy.yml                # GitHub Actions ìë™ ë°°í¬
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app.js                        # ì—”íŠ¸ë¦¬í¬ì¸íŠ¸ (Bolt ì´ˆê¸°í™” + ìë™ ê°ì§€ ì‹œì‘)
â”‚   â”œâ”€â”€ monitor/
â”‚   â”‚   â”œâ”€â”€ alertState.js             # ì¥ì•  ìƒíƒœ ê´€ë¦¬ (íŒŒì¼ ì˜ì†í™” + ë ˆì´ìŠ¤ ì»¨ë””ì…˜)
â”‚   â”‚   â””â”€â”€ errorChecker.js           # 5ë¶„ ì£¼ê¸° ìë™ ê°ì§€ + ì •ìƒí™” ê°ì§€ + í•˜ë£¨ ìŠ¤ë ˆë“œ
â”‚   â”œâ”€â”€ actions/
â”‚   â”‚   â”œâ”€â”€ openSmsModal.js           # [ë¬¸ì ë°œì†¡] â†’ ëª¨ë‹¬ ì—´ê¸°
â”‚   â”‚   â”œâ”€â”€ openRecoveryModal.js      # [í•´ì œ ë¬¸ì ë°œì†¡] â†’ ëª¨ë‹¬ ì—´ê¸°
â”‚   â”‚   â”œâ”€â”€ dismiss.js                # [ë¬¸ì ë°œì†¡ ì•ˆí•¨] â†’ ì²˜ë¦¬ì ë°•ì œ
â”‚   â”‚   â”œâ”€â”€ skipRecovery.js           # [í•´ì œ ë¬¸ì ë°œì†¡ ì•ˆí•¨] â†’ ì²˜ë¦¬ì ë°•ì œ
â”‚   â”‚   â””â”€â”€ templateChange.js         # í…œí”Œë¦¿ ë“œë¡­ë‹¤ìš´ ë³€ê²½ â†’ ë¬¸êµ¬ ìë™ ì±„ì›€
â”‚   â”œâ”€â”€ views/
â”‚   â”‚   â””â”€â”€ smsModal.js               # ëª¨ë‹¬ UI (6ì¢… í…œí”Œë¦¿ + í™•ì¸ ì²´í¬ë°•ìŠ¤ 2ê°œ)
â”‚   â”œâ”€â”€ submissions/
â”‚   â”‚   â””â”€â”€ handleSmsSend.js          # ëª¨ë‹¬ ì œì¶œ â†’ ì²´í¬ë°•ìŠ¤ ê²€ì¦ â†’ ë ˆì´ìŠ¤ ì»¨ë””ì…˜ â†’ ë°œì†¡ â†’ ìŠ¤ë ˆë“œ ê²°ê³¼
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ retool.js                 # Retool ëŒ€ìƒ ì¶”ì¶œ Workflow í˜¸ì¶œ
â”‚   â”‚   â”œâ”€â”€ solapi.js                 # Solapi ë¬¸ì ë°œì†¡ (í…ŒìŠ¤íŠ¸ ëª¨ë“œ ì§€ì›)
â”‚   â”‚   â”œâ”€â”€ phoneParser.js            # ì „í™”ë²ˆí˜¸ íŒŒì‹±/ì •ì œ
â”‚   â”‚   â””â”€â”€ resultCsv.js              # CSV ìƒì„± + Slack íŒŒì¼ ì—…ë¡œë“œ
â”‚   â”œâ”€â”€ blocks/
â”‚   â”‚   â”œâ”€â”€ alertMessage.js           # ì¥ì•  ê°ì§€ ì•Œë¦¼ Block Kit
â”‚   â”‚   â”œâ”€â”€ recoveryMessage.js        # ì •ìƒí™” ì•Œë¦¼ Block Kit
â”‚   â”‚   â”œâ”€â”€ resultMessage.js          # ë°œì†¡ ê²°ê³¼ Block Kit
â”‚   â”‚   â”œâ”€â”€ failureDetail.js          # ì‹¤íŒ¨ ìƒì„¸ Block Kit
â”‚   â”‚   â”œâ”€â”€ phoneListMessage.js       # ìˆ™ë°•ì—…ì†Œë³„ ë²ˆí˜¸ ë¦¬ìŠ¤íŠ¸ Block Kit
â”‚   â”‚   â””â”€â”€ dismissedMessage.js       # ë¬¸ì ë°œì†¡ ì•ˆí•¨ Block Kit (ì¥ì• /í•´ì œ ê³µìš©)
â”‚   â”œâ”€â”€ templates/
â”‚   â”‚   â””â”€â”€ index.js                  # ë¬¸ì í…œí”Œë¦¿ 6ì¢…
â”‚   â””â”€â”€ utils/
â”‚       â””â”€â”€ time.js                   # ë‚ ì§œ/ì‹œê°„ í¬ë§· ìœ í‹¸
â”œâ”€â”€ test/
â”‚   â””â”€â”€ sendTestAlert.js              # í…ŒìŠ¤íŠ¸ ì•Œë¦¼ ë°œì†¡ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ .alert-state.json                 # ìƒíƒœ ì˜ì†í™” íŒŒì¼ (ìë™ ìƒì„±, git ë¯¸í¬í•¨)
â”œâ”€â”€ .env                              # í™˜ê²½ ë³€ìˆ˜ (git ë¯¸í¬í•¨)
â”œâ”€â”€ .env.example
â”œâ”€â”€ .gitignore
â”œâ”€â”€ package.json
â””â”€â”€ README.md
```

---

## í™˜ê²½ ë³€ìˆ˜

```env
# Slack
SLACK_BOT_TOKEN=xoxb-xxxx
SLACK_SIGNING_SECRET=xxxx
SLACK_APP_TOKEN=xapp-xxxx                # Socket Mode
SLACK_ALERT_CHANNEL=C04ACB66X7C          # í”„ë¡œë•ì…˜: lounge-vcms

# Retool - ëŒ€ìƒ ì¶”ì¶œ ì›Œí¬í”Œë¡œìš°
RETOOL_WORKFLOW_URL=https://api.retool.com/v1/workflows/xxx/startTrigger
RETOOL_API_KEY=xxxx

# Retool - ìë™ ê°ì§€ ì²´í¬ ì›Œí¬í”Œë¡œìš°
RETOOL_CHECK_WORKFLOW_URL=https://api.retool.com/v1/workflows/yyy/startTrigger
RETOOL_CHECK_API_KEY=xxxx

# Solapi
SOLAPI_API_KEY=xxxx
SOLAPI_API_SECRET=xxxx
SOLAPI_SENDER=02-xxxx-xxxx               # ë°œì‹ ë²ˆí˜¸ (ì‚¬ì „ ë“±ë¡ í•„ìˆ˜)

# ëª¨ë‹ˆí„°ë§ ì„¤ì •
ALERT_THRESHOLD=30                       # ì¥ì•  ê°ì§€ ì„ê³„ì¹˜ (ì—ëŸ¬ ìˆ™ë°•ì—…ì†Œ ìˆ˜)
RECOVERY_THRESHOLD=10                    # ì •ìƒí™” ì„ê³„ì¹˜ (ì´í•˜ë¡œ ë‚´ë ¤ê°€ë©´ í•´ì œ)

# í…ŒìŠ¤íŠ¸ ëª¨ë“œ (ì„¤ì • ì‹œ í•´ë‹¹ ë²ˆí˜¸ë¡œë§Œ ë°œì†¡, ì‚­ì œ ì‹œ ì‹¤ë°œì†¡)
# TEST_PHONE=010xxxx1234
```

---

## Slack Bot Scopes (í•„ìˆ˜)

Slack API â†’ OAuth & Permissions â†’ Bot Token Scopes:

| Scope | ìš©ë„ |
|-------|------|
| `chat:write` | ë©”ì‹œì§€ ë³´ë‚´ê¸° |
| `channels:history` | ì±„ë„ ë©”ì‹œì§€ ì½ê¸° (ì›ë³¸ ë©”ì‹œì§€ ì—…ë°ì´íŠ¸ìš©) |
| `groups:history` | private ì±„ë„ ë©”ì‹œì§€ ì½ê¸° |
| `channels:read` | ì±„ë„ ì •ë³´ ì¡°íšŒ |
| `im:write` | DM ë³´ë‚´ê¸° (ì—ëŸ¬ ì•Œë¦¼) |
| `im:read` | DM ì½ê¸° |
| `users:read` | ìœ ì € ì •ë³´ ì¡°íšŒ |
| `reactions:write` | ì´ëª¨ì§€ ë¦¬ì•¡ì…˜ |
| `files:write` | CSV íŒŒì¼ ì—…ë¡œë“œ |

ì¶”ê°€ í›„ **Reinstall App** í•„ìˆ˜!

---

## ë¹ ë¥¸ ì‹œì‘

```bash
git clone https://github.com/yujy118/vcms-slack-anolja-bot.git
cd vcms-slack-anolja-bot
npm install
cp .env.example .env   # í† í°/í‚¤ ì…ë ¥
npm start
```

### í…ŒìŠ¤íŠ¸

```bash
# ë´‡ ì‹¤í–‰ ì¤‘ì¸ ìƒíƒœì—ì„œ ë‹¤ë¥¸ í„°ë¯¸ë„ì—ì„œ:
node test/sendTestAlert.js
```

### pm2ë¡œ ìƒì‹œ ì‹¤í–‰

```bash
npm install -g pm2
pm2 start src/app.js --name anolja-bot
pm2 save
pm2 startup    # ì¶œë ¥ëœ sudo ëª…ë ¹ì–´ ì‹¤í–‰
```

---

## ë¼ì´ì„ ìŠ¤

VENDIT ë‚´ë¶€ í”„ë¡œì íŠ¸
